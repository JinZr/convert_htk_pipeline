# Convert HTK Pipeline

[toc]

## Intro
This repo is for researchers or engineerers who need to generate acoustic feature using HTK, but have to use Python for further training or processing.

Note that this repo is for UASpeech Only, for other datasets, some functions in ./tempo/tempo.py have to be altered to fit the very different format.

To see implemented features, please check [TODO List](##3).

For usage, please refer to [Manual](##4)

### Tempo Stretch
This chapter introduces the process of tempo stretch.

**TODO**

## Requirements
- Python
  - pysox
  - tqdm
  - scipy
  

## TODO List
- Tempo stretch
- Generate acoustic using HTK
  - PLP
  - FBank
- ❎ CMVN
- ❎ Convert HTK generated acoustic feature to Kaldi format
- ❎ Convert Kaldi format acoustic to a Python readable format
- Single-Pass Retraining ```For reference, please check HTK Book Page 167, *Single-Pass Retraining* ```
  - [HTK Book Page](https://www.researchgate.net/publication/289354717_The_HTK_Book_version_35a)

## Manual

### path.global.sh

This file configures global path variables.

- SPKR_IDs - list: an array that contains all speaker ids, modify this under the situation that you have multiple speakers having their waveform or acoustic feature under each folder.
- BASE_PATH - str: **absolute** path to target folder, all output from intermediate steps will be archived under this folder.
- ORIGINAL_FILE_LIST_PATH - str: **absolute** path to SCP file of original dataset, note that file name in this SCP file must follows standard HTK filename format and contains time stamp generated by HTK (e.g. ```/project/bdda/mengzhe/DataAugmentation/Data/UASpeech/UASpeech_trim/train/UASPCH-XCF05-XXB3CF05-UACF05-ih_XUW90M5_0000026_0000130.wav```).
- WAV_PATH - str: folder name of which stores the original waveform files (e.g. ```WAVE/```), the final path would be ```BASE_PATH/WAV_PATH/```.
- PLP_SCP_PATH - str: folder name of which stores the SCP file for HTK generated PLP feature (e.g. ```PLP_SCP/```), the final path would be ```BASE_PATH/PLP_SCP_PATH/```.
- PLP_PATH - str: folder name of which stores the HTK generated PLP feature (e.g. ```PLP/```), the final path would be ```BASE_PATH/PLP_PATH/```.
- FBK_SCP_PATH - str: folder name of which stores the SCP file for HTK generated FBK feature (e.g. ```FBK_SCP/```), the final path would be ```BASE_PATH/FBK_SCP_PATH/```.
- FBK_PATH - str: folder name of which stores the HTK generated FBK feature (e.g. ```FBK/```), the final path would be ```BASE_PATH/FBK_PATH/```.
- FILE_LIST_PATH - str: folder name of which stores the temperate SCP file for generated PLP or FBK feature that haven't been attached with time stamp yet (e.g. ```TEMP/```), the final path would be ```BASE_PATH/FILE_LIST_PATH/```.
- FILE_LIST_TIME_STAMP_PATH - str: folder name of which stores the temperate SCP file for generated PLP or FBK feature that have been attached with time stamp yet (e.g. ```STMP/```), the final path would be ```BASE_PATH/FILE_LIST_TIME_STAMP_PATH/```.

### bool.global.sh

This file configures global boolean variables.

- SHOW_WARNING - bool: set logging level for SOX and pysox, set to false to display error level log only.
- TEMPO_BOOL - bool: set to true to enable tempo stretch.
- FBK - bool: generate FBK feature.
- PLP - bool: generate PLP feature.
